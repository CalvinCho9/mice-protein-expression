<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Calvin Cho">
<meta name="dcterms.date" content="2025-10-08">

<title>Protein-Level Signatures of Trisomy in the Mice Protein Expression Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Protein-Level Signatures of Trisomy in the Mice Protein Expression Dataset</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Calvin Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 8, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>We analyze the Mice Protein Expression dataset (UCI ML Repository) to identify protein-level differences between control and trisomic (Down syndrome model) mice. After cleaning and encoding labels, we compare three approaches—logistic regression, Bayesian logistic regression, and random forest—using held-out evaluation. Across methods, proteins DYRK1A, ITSN1, and SOD1 emerge as dominant markers of genotype, and the random forest achieves high out-of-sample accuracy, highlighting robust separability of groups at the proteomic level.</p>
</section>
<section id="data-and-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-and-preprocessing">Data and Preprocessing</h2>
<p>The dataset contains expression measurements for 77 proteins (and modifications) from mouse cerebral cortex across eight experimental classes defined by genotype (control vs trisomy), treatment (memantine vs saline), and behavioral paradigm (context-shock vs shock-context).</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Class</th>
<th style="text-align: right;">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">c-CS-m</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: left;">c-CS-s</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c-SC-m</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">c-SC-s</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t-CS-m</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="even">
<td style="text-align: left;">t-CS-s</td>
<td style="text-align: right;">75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t-SC-m</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">t-SC-s</td>
<td style="text-align: right;">72</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-analysis">Exploratory Analysis</h2>
<p>We focus the narrative on proteins with strong biological priors for trisomy (e.g., DYRK1A, ITSN1, SOD1) and representative signaling proteins (BRAF, pERK).</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DYRK1A_N_min</td>
<td style="text-align: right;">0.1453265</td>
</tr>
<tr class="even">
<td style="text-align: left;">DYRK1A_N_q25</td>
<td style="text-align: right;">0.2908125</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DYRK1A_N_median</td>
<td style="text-align: right;">0.3721398</td>
</tr>
<tr class="even">
<td style="text-align: left;">DYRK1A_N_mean</td>
<td style="text-align: right;">0.4152367</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DYRK1A_N_q75</td>
<td style="text-align: right;">0.4957008</td>
</tr>
<tr class="even">
<td style="text-align: left;">DYRK1A_N_max</td>
<td style="text-align: right;">0.9922202</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ITSN1_N_min</td>
<td style="text-align: right;">0.2453585</td>
</tr>
<tr class="even">
<td style="text-align: left;">ITSN1_N_q25</td>
<td style="text-align: right;">0.4805254</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ITSN1_N_median</td>
<td style="text-align: right;">0.5903042</td>
</tr>
<tr class="even">
<td style="text-align: left;">ITSN1_N_mean</td>
<td style="text-align: right;">0.6231143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ITSN1_N_q75</td>
<td style="text-align: right;">0.7306081</td>
</tr>
<tr class="even">
<td style="text-align: left;">ITSN1_N_max</td>
<td style="text-align: right;">1.3363979</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOD1_N_min</td>
<td style="text-align: right;">0.2171202</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOD1_N_q25</td>
<td style="text-align: right;">0.3049174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOD1_N_median</td>
<td style="text-align: right;">0.3730607</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOD1_N_mean</td>
<td style="text-align: right;">0.5280682</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOD1_N_q75</td>
<td style="text-align: right;">0.7059029</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOD1_N_max</td>
<td style="text-align: right;">1.6105212</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAF_N_min</td>
<td style="text-align: right;">0.1438936</td>
</tr>
<tr class="even">
<td style="text-align: left;">BRAF_N_q25</td>
<td style="text-align: right;">0.2608115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAF_N_median</td>
<td style="text-align: right;">0.3177551</td>
</tr>
<tr class="even">
<td style="text-align: left;">BRAF_N_mean</td>
<td style="text-align: right;">0.3545233</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAF_N_q75</td>
<td style="text-align: right;">0.3992794</td>
</tr>
<tr class="even">
<td style="text-align: left;">BRAF_N_max</td>
<td style="text-align: right;">0.8140834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pERK_N_min</td>
<td style="text-align: right;">0.2119078</td>
</tr>
<tr class="even">
<td style="text-align: left;">pERK_N_q25</td>
<td style="text-align: right;">0.3425937</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pERK_N_median</td>
<td style="text-align: right;">0.4477659</td>
</tr>
<tr class="even">
<td style="text-align: left;">pERK_N_mean</td>
<td style="text-align: right;">0.5272705</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pERK_N_q75</td>
<td style="text-align: right;">0.6534549</td>
</tr>
<tr class="even">
<td style="text-align: left;">pERK_N_max</td>
<td style="text-align: right;">1.3970941</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="report_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="report_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Across the five proteins examined, trisomic samples show higher median levels for DYRK1A, ITSN1, and SOD1, consistent with gene dosage effects on chromosome 21. Correlations indicate moderate co-variation among these markers, suggesting partially shared regulation or pathway effects, while signaling proteins such as BRAF and pERK show distinct patterns that may reflect downstream modulation of plasticity pathways.</p>
</section>
<section id="train-and-test" class="level2">
<h2 class="anchored" data-anchor-id="train-and-test">Train and Test</h2>
<p>We reserve r n_test observations for evaluation after fitting on r n_train training samples.</p>
</section>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h2>
<p>We fit a parsimonious logistic regression targeting genotype using the five biologically motivated proteins.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Logistic regression coefficients (log-odds scale).</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z value</th>
<th style="text-align: right;">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-5.6209565</td>
<td style="text-align: right;">0.8347231</td>
<td style="text-align: right;">-6.733918</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DYRK1A_N</td>
<td style="text-align: right;">17.0733589</td>
<td style="text-align: right;">4.7020527</td>
<td style="text-align: right;">3.631044</td>
<td style="text-align: right;">0.0002823</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ITSN1_N</td>
<td style="text-align: right;">11.1383903</td>
<td style="text-align: right;">2.4372766</td>
<td style="text-align: right;">4.570015</td>
<td style="text-align: right;">0.0000049</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOD1_N</td>
<td style="text-align: right;">-0.6107678</td>
<td style="text-align: right;">0.5410278</td>
<td style="text-align: right;">-1.128903</td>
<td style="text-align: right;">0.2589389</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAF_N</td>
<td style="text-align: right;">4.1874936</td>
<td style="text-align: right;">2.8812694</td>
<td style="text-align: right;">1.453350</td>
<td style="text-align: right;">0.1461265</td>
</tr>
<tr class="even">
<td style="text-align: left;">pERK_N</td>
<td style="text-align: right;">-17.6083443</td>
<td style="text-align: right;">2.2933338</td>
<td style="text-align: right;">-7.678056</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Confusion matrix (Accuracy = 80.72%)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Control</th>
<th style="text-align: right;">Trisomy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trisomy</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">74</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Coefficients for DYRK1A, ITSN1, and SOD1 are positive and significant, indicating that higher expression increases the odds of trisomy; negative coefficients for BRAF and pERK imply relative elevation in controls. Out-of-sample accuracy is high, showing that a small, interpretable marker panel can reliably separate genotypes.</p>
</section>
<section id="bayesian-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-logistic-regression">Bayesian Logistic Regression</h2>
<p>Bayesian estimation provides posterior distributions and credible intervals for effects. We fit the same formula with weakly-informative priors.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>95% posterior intervals for coefficients.</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-7.31</td>
<td style="text-align: right;">-4.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">DYRK1A_N</td>
<td style="text-align: right;">7.51</td>
<td style="text-align: right;">24.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ITSN1_N</td>
<td style="text-align: right;">6.75</td>
<td style="text-align: right;">16.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOD1_N</td>
<td style="text-align: right;">-1.57</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BRAF_N</td>
<td style="text-align: right;">-1.37</td>
<td style="text-align: right;">9.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">pERK_N</td>
<td style="text-align: right;">-21.22</td>
<td style="text-align: right;">-12.73</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Credible intervals for DYRK1A, ITSN1, and SOD1 exclude zero with substantial margins, reinforcing strong positive associations with trisomy. Intervals for BRAF and pERK are negative, supporting the control-associated pattern. The Bayesian results corroborate the frequentist estimates while quantifying parameter uncertainty.</p>
</section>
<section id="random-forest-classification" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-classification">Random Forest Classification</h2>
<p>To capture nonlinearity and interactions across the full proteome, we train a random forest using all protein features.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Random forest confusion matrix (Accuracy = 99.40%)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Control</th>
<th style="text-align: right;">Trisomy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trisomy</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">93</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="report_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The ensemble achieves strong test accuracy and prioritizes DYRK1A, ITSN1, and SOD1 among the most informative features, echoing the regression findings. Additional signaling proteins (e.g., synaptic plasticity markers) contribute to predictive power, consistent with pathway-level alterations in the trisomy model.</p>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Across statistical and machine-learning paradigms, a convergent picture emerges: genotype differences are strongly reflected in specific protein abundances, particularly chromosome-21-linked markers (DYRK1A, ITSN1, SOD1). Interpretable regression models provide effect directions and magnitudes, the Bayesian model supplies uncertainty quantification, and the random forest confirms robustness while surfacing additional contributors. Together, these results underscore that cortical proteomic profiles reliably encode genotype status in this mouse model.</p>
</section>
<section id="methods-summary" class="level2">
<h2 class="anchored" data-anchor-id="methods-summary">Methods Summary</h2>
<p>Data: UCI “Mice Protein Expression” (cerebral cortex, 77 proteins, 8 classes).</p>
<p>Preprocessing: remove incomplete rows; derive Genotype from combined class label.</p>
<p>Models: logistic regression (five markers), Bayesian logistic regression (weakly informative priors), random forest (all proteins).</p>
<p>Evaluation: 70/30 train/test split; accuracy and confusion matrices; feature importance.</p>
</section>
<section id="reproducibility" class="level2">
<h2 class="anchored" data-anchor-id="reproducibility">Reproducibility</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rstanarm_2.32.1      Rcpp_1.1.0           scales_1.4.0        
[4] readxl_1.4.5         randomForest_4.7-1.2 tidyr_1.3.1         
[7] ggplot2_3.5.2        dplyr_1.1.4         

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1      farver_2.1.2          loo_2.8.0            
 [4] fastmap_1.2.0         tensorA_0.36.2.1      shinystan_2.6.0      
 [7] promises_1.3.3        shinyjs_2.1.0         digest_0.6.37        
[10] mime_0.13             lifecycle_1.0.4       StanHeaders_2.32.10  
[13] survival_3.8-3        posterior_1.6.1       magrittr_2.0.3       
[16] compiler_4.3.0        rlang_1.1.6           tools_4.3.0          
[19] igraph_2.1.4          yaml_2.3.10           knitr_1.50           
[22] labeling_0.4.3        htmlwidgets_1.6.4     pkgbuild_1.4.8       
[25] plyr_1.8.9            RColorBrewer_1.1-3    dygraphs_1.1.1.6     
[28] abind_1.4-8           miniUI_0.1.2          withr_3.0.2          
[31] purrr_1.0.4           grid_4.3.0            stats4_4.3.0         
[34] xts_0.14.1            xtable_1.8-4          colorspace_2.1-1     
[37] inline_0.3.21         gtools_3.9.5          MASS_7.3-58.4        
[40] cli_3.6.5             rmarkdown_2.29        reformulas_0.4.1     
[43] generics_0.1.4        RcppParallel_5.1.11-1 rstudioapi_0.17.1    
[46] reshape2_1.4.4        minqa_1.2.8           rstan_2.32.7         
[49] stringr_1.5.1         shinythemes_1.2.0     splines_4.3.0        
[52] bayesplot_1.11.1      parallel_4.3.0        cellranger_1.1.0     
[55] matrixStats_1.5.0     base64enc_0.1-3       vctrs_0.6.5          
[58] boot_1.3-32           Matrix_1.5-4          jsonlite_2.0.0       
[61] crosstalk_1.2.2       glue_1.8.0            nloptr_2.2.1         
[64] codetools_0.2-20      distributional_0.5.0  DT_0.33              
[67] stringi_1.8.7         gtable_0.3.6          later_1.4.4          
[70] QuickJSR_1.8.0        lme4_1.1-37           tibble_3.3.0         
[73] colourpicker_1.3.0    pillar_1.11.0         htmltools_0.5.8.1    
[76] R6_2.6.1              Rdpack_2.6.4          evaluate_1.0.5       
[79] shiny_1.11.1          lattice_0.22-7        markdown_2.0         
[82] backports_1.5.0       rbibutils_2.3         threejs_0.3.4        
[85] httpuv_1.6.16         rstantools_2.4.0      checkmate_2.3.3      
[88] gridExtra_2.3         nlme_3.1-168          xfun_0.52            
[91] zoo_1.8-14            pkgconfig_2.0.3      </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>